# 奇门遁甲排盘系统

基于传统命理学算法的奇门遁甲排盘系统，包含四柱八字计算和奇门遁甲排盘功能。

## ⚠️ 重要声明

**本系统仅供学习研究使用，不保证算法的绝对正确性。** 
- 四柱八字和奇门遁甲属于传统命理学范畴，其理论基础和计算方法存在多种流派和解释
- 本系统实现基于公开的传统算法，但可能与某些专业流派的计算结果存在差异
- 排盘结果仅供参考，不应作为任何决策依据
- 使用本系统产生的一切后果由使用者自行承担

## 🔍 专业评估说明

**关于奇门遁甲计算准确性的重要说明：**

经过专业代码审查，本系统中的奇门遁甲排盘算法存在以下局限性：

1. **核心算法简化**：为了便于理解和实现，代码采用了高度简化的算法，未严格按照传统奇门遁甲的复杂计算流程
2. **定局算法错误**：正确的奇门遁甲定局完全依赖于节气和旬首，而本系统使用了简化的基于日干支的计算方法
3. **缺少关键概念**：未实现"旬首"、"超神接气"等奇门遁甲的核心概念
4. **排盘准确性有限**：由于上述原因，排盘结果的准确性无法保证，仅可作为学习参考

**建议**：
- 如需准确的奇门遁甲排盘，请使用专业的商用软件或手动排盘
- 本系统更适合用于学习奇门遁甲的基本概念和排盘流程
- 对于严肃的预测应用，请咨询专业的命理师

## 简介

本系统包含两个核心功能模块：

### 1. 四柱八字计算
基于传统命理学算法计算年柱、月柱、日柱、时柱，特别注重：
- 准确的节气计算（月柱依据节气划分）
- 正确的年柱分界（以立春为界）
- 标准的日柱计算方法
- 传统的时柱计算（五鼠遁时）

### 2. 奇门遁甲排盘
基于传统奇门遁甲理论进行排盘，包含：
- 九宫八卦布局
- 八门、九星、八神分布
- 天干地支配置
- 特殊神煞标记

## 安装

```bash
# 克隆项目
git clone https://github.com/caihaoran-00/qimenpaipan
cd qimenpaipan

# 运行
python main.py
```

## 使用方法

### 基本使用

```python
from qimen_system import QiMenDunJia

# 创建奇门遁甲排盘实例
qimen = QiMenDunJia(2025, 8, 20, 17, 43)  # 年, 月, 日, 时, 分

# 显示排盘结果
qimen.display()
```

### 四柱八字单独使用

```python
from qimen_system.sizhu_calculator import SiZhuCalculator

# 创建四柱计算器实例
calculator = SiZhuCalculator(2025, 8, 20, 17, 43)  # 年, 月, 日, 时, 分

# 获取四柱结果
sizhu = calculator.get_sizhu()
print(sizhu)
# 输出: {'年柱': ('乙', '巳'), '月柱': ('甲', '申'), '日柱': ('辛', '酉'), '时柱': ('丁', '酉')}
```

## 核心算法

### 四柱八字计算

#### 1. 年柱计算
- 以**立春**为分界点
- 年干 = (年份 - 3) % 10
- 年支 = (年份 - 3) % 12

#### 2. 月柱计算
- 严格依据**二十四节气**划分
- 月干使用**五虎遁口诀**推算

#### 3. 日柱计算
- 支持年份范围：1901-2100年
- 使用传统公式计算日干支
- 超出范围年份会抛出异常

#### 4. 时柱计算
- 按传统十二时辰划分（每时辰2小时）
- 时干使用**五鼠遁口诀**推算

### 奇门遁甲排盘

#### 1. 局数确定
- 根据节气、日干支和时辰确定阴阳遁及局数
- 自动计算值符、值使位置

#### 2. 九宫布局
- 按照传统奇门遁甲理论进行九宫八卦布局
- 分配八门、九星、八神到各个宫位

## 特点与优势

### 1. 算法准确性
- 严格按照传统命理学算法实现
- 月柱计算基于二十四节气
- 年柱以立春为分界点

### 2. 功能完整性
- 包含完整的四柱八字计算
- 实现奇门遁甲九宫排盘
- 支持特殊神煞标记（驿马、贵人等）

### 3. 使用便捷性
- 简洁的API接口
- 清晰的结果输出
- 支持JSON格式数据导出

## 示例结果

### 2025年8月20日17:43排盘结果
```
公历: 2025-08-20 17:43
农历: 二零二五年闰六月二十七 乙巳年 (蛇年)
四柱: 乙巳 甲申 辛酉 丁酉
局数: 阴9局
驿马: 卯, 贵人: 寅, 午
```

## 依赖

- Python 3.6+
- datetime
- json
- typing
- zhdate

## 注意事项

1. 本系统严格按照传统命理学算法实现，但不同流派可能存在差异
2. 日柱计算仅支持1901-2100年范围，超出范围会抛出异常
3. 本系统不提供专业命理咨询服务
4. 排盘结果仅供学习研究使用，请勿用于商业或迷信活动
5. 如需高精度计算请参考专业历法数据和权威文献

## 免责声明

1. 本系统所提供的所有信息仅供学习交流使用，不构成任何形式的专业建议
2. 用户在使用本系统时应当遵守相关法律法规，不得用于非法用途
3. 作者不对用户因使用本系统所产生的任何直接或间接损失承担责任
4. 本系统可能存在算法误差，不保证计算结果的绝对准确性
5. 用户使用本系统即视为同意承担所有使用风险